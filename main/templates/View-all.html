{% load static %} {% csrf_token %}
<!DOCTYPE>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>View All Student</title>
  <link rel="stylesheet" href="{% static 'css/search&viewStudents.css'%}" />
  <link rel="stylesheet" href="{% static 'css/NavBar.css'%}" />
  <link href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" rel="stylesheet" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <div class="nav">
    <nav class="nav-bar">
      <div class="nav-left">
        <a href="/HomePage" class="nav-menu">Home <img src="{% static 'images/home.png'%}" class="nav-menue-logo" /></a>
        <a href="/Add_Student" class="nav-menu">Add Student <img src="{% static 'images/add.png'%}"
            class="nav-menue-logo" /></a>
        <a href="/Edit_student_data" class="nav-menu">Edit Student info <img src="{% static 'images/edit.png'%}"
            class="nav-menue-logo" /></a>
      </div>
      <div class="nav-right">
        <a href="/Search" class="nav-menu">Search <img src="{% static 'images/search.png'%}"
            class="nav-menue-logo" /></a>
        <a href="/View-all" class="active-menu-right">View All Students <img src="{% static 'images/all.png'%}"
            class="nav-menue-logo" /></a>
        <a href="/loginPage" class="nav-menu">Log in <img src="{% static 'images/login.png'%}"
            class="nav-menue-logo" /></a>
      </div>
    </nav>
    <a href="/HomePage"><img src="{% static 'images/nav-logo.png'%}" class="logo" /></a>
  </div>
  <div class="hamburger-menu">
    <nav class="hum-nav">
      <img src="{% static 'images/humburger.png'%}" id="hum-btn" />
    </nav>
    <a href="/HomePage"><img src="{% static 'images/logo.png'%}" id="hum-logo" /></a>
    <ul id="menu-list">
      <a href="/HomePage">
        <li class="menu-element">Home <img src="{% static 'images/home.png'%}" class="nav-menue-logo" /></li>
      </a>
      <a href="/Add_Student">
        <li class="menu-element">Add Student <img src="{% static 'images/add.png'%}" class="nav-menue-logo" /></li>
      </a>
      <a href="/Edit_student_data">
        <li class="menu-element">Edit Student info <img src="{% static 'images/edit.png'%}" class="nav-menue-logo" />
        </li>
      </a>
      <a href="/Search">
        <li class="menu-element">Search <img src="{% static 'images/search.png'%}" class="nav-menue-logo" /></li>
      </a>
      <a href="/View-all">
        <li class="menu-element-active">View All Students <img src="{% static 'images/all.png'%}"
            class="nav-menue-logo" /></li>
      </a>
      <a href="/loginPage">
        <li class="menu-element">Log in <img src="{% static 'images/login.png'%}" class="nav-menue-logo" /></li>
      </a>
    </ul>
  </div>

  <div class="tbl">
    <table>
      <thead>
        <tr class="head">
          <th></th>
          <th>Name:</th>
          <th>ID:</th>
          <th>Status:</th>
          <th>Edit</th>
          <th>Assign department</th>
        </tr>
      </thead>
      <tbody id="tableData"></tbody>


    </table>
  </div>

  <script>
    request = new XMLHttpRequest();
    request.open("GET", "/getAllStudents/");
    csrftoken = document.cookie.split('csrftoken')[1].split('=')[1];
    request.setRequestHeader("X-CSRFToken", csrftoken);
    request.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
    request.onload = () => {
      var students = JSON.parse(request.responseText)['Students'];
      var k = '<tbody>'
      for (i = 0; i < students.length; i++) {
        var img, stat;
        if (students[i]['image'] == '') {
          if (students[i]['gender'] == 'male') {
            img = "{% static 'images/male_user.png'%}";
          } else {
            img = "{% static 'images/female_user.png'%}";
          }
        } else {
          var p = students[i]['image'].split('static/')[1];
          img = "{% get_static_prefix %}" + p;
        }
        if (students[i]['status'] == 'active') {
          stat = "<p style = \"color: green\">Active</p>";
        } else {
          stat = "<p style = \"color: red\">InActive</p>";
        }
        k += '<tr class=\"rw\">';
        k += '<td class=\"img\"><img src=\"' + img + '\"></td>';
        k += '<td class=\"name\">' + students[i]['name'] + '</td>';
        k += '<td class=\"id\">' + students[i]['id'].toString() + '</td>';
        k += '<td class=\"swtch\">' + stat + '</td>';
        k += '<td class=\"btn\"><button onclick=\"window.location.href=\'/Edit_student_data\'\"><i class=\"fas fa-pen\" ></i></button></td>';
        k += '<td class=\"btn\"><a href=\"/assign\" ><img src=\"' + "{% static 'images/department.png'%}" + '\" id=\"depimg\"/></a></td>';
        k += '</tr>';
      }
      k += '</tbody>';
      document.getElementById('tableData').innerHTML = k;
    }
    request.send();
  </script>
  <script src="{% static 'JS/nav.js'%}"></script>
</body>